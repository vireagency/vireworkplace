import{r as s,n as C,p as T,o as R,R as E,t as P,j as e,L}from"./index-DSewVFua.js";import{C as O,a as k,c as S,d as A,e as B,B as h}from"./card-EJ5g6USJ.js";import{L as F,I as M}from"./label-BahFRQBq.js";import{R as q}from"./refresh-cw-dVySPRP4.js";import{A as D}from"./arrow-left-Cfpt0CiH.js";import"./index-C13qTn-R.js";function G(){const[a,p]=s.useState(""),[i,u]=s.useState(!1),[c,n]=s.useState(""),[t,x]=s.useState(0),l=C(),f=T(),{secureAxios:g}=R(),d=s.useCallback(r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r),[]);E.useEffect(()=>{if(t>0){const r=setTimeout(()=>x(t-1),1e3);return()=>clearTimeout(r)}},[t]);const b=s.useCallback(async r=>{if(r.preventDefault(),!a.trim()){n("Email is required");return}if(!d(a)){n("Please enter a valid email address");return}try{u(!0),n("");const o=await g.post("/auth/otp/resend",{email:a.trim()});if(o.data.success){P.success("OTP has been resent to your email!"),x(60);const{mode:m}=f.state||{};m==="forgot-password"?l("/otp-confirmation",{state:{email:a.trim(),mode:"forgot-password"}}):l("/otp-confirmation",{state:{email:a.trim(),mode:"signup"}})}else n(o.data.message||"Failed to resend OTP")}catch(o){console.error("OTP resend error:",o);const m=o.response?.data?.message||o.message||"Failed to resend OTP. Please try again.";n(m)}finally{u(!1)}},[a,d,g,l,f.state]),j=s.useCallback(()=>{l("/login")},[l]),y=s.useCallback(r=>{p(r.target.value),c&&n("")},[c]),w=s.useMemo(()=>a.trim()&&d(a),[a,d]),v=s.useMemo(()=>i?"Sending...":"Resend OTP",[i]),N=s.useMemo(()=>t===0,[t]);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsxs(O,{className:"w-full max-w-md shadow-xl",children:[e.jsxs(k,{className:"text-center space-y-2",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-blue-600"})}),e.jsx(S,{className:"text-2xl font-bold text-gray-900",children:"Resend OTP"}),e.jsx(A,{className:"text-gray-600",children:"Enter your email address to receive a new OTP verification code."})]}),e.jsx(B,{children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email Address"}),e.jsx(M,{id:"email",type:"email",placeholder:"Enter your email",value:a,onChange:y,className:"w-full",disabled:i,required:!0})]}),c&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:c}),e.jsxs(h,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:!w||i||!N,children:[i&&e.jsx(L,{className:"w-4 h-4 mr-2 animate-spin"}),v]}),t>0&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["Resend available in ",t," seconds"]}),e.jsxs(h,{type:"button",variant:"ghost",onClick:j,className:"w-full text-gray-600 hover:text-gray-800",disabled:i,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]})})]})})}export{G as default};
