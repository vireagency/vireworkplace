import{r as a,n as B,p as M,o as R,t as T,j as s,L as q}from"./index-DSewVFua.js";import{C as z,a as F,c as I,d as D,e as V,B as h}from"./card-EJ5g6USJ.js";import{L as p,I as P}from"./label-BahFRQBq.js";import{L as H,E as O}from"./lock-Dke5W_RG.js";import{E as Z}from"./eye-BxK6y9hd.js";import{A as $}from"./arrow-left-Cfpt0CiH.js";import"./index-C13qTn-R.js";function Y(){const[t,j]=a.useState(""),[i,N]=a.useState(""),[x,y]=a.useState(!1),[n,f]=a.useState(!1),[l,o]=a.useState(""),d=B(),g=M(),{secureAxios:b}=R(),u=a.useCallback(e=>e&&e.length>=6,[]),m=a.useCallback((e,r)=>e===r,[]),w=a.useCallback(e=>{const r=/[a-zA-Z]/.test(e),c=/\d/.test(e);return e.length>=6&&r&&c},[]),C=a.useCallback(async e=>{if(e.preventDefault(),!u(t)){o("Password must be at least 6 characters long");return}if(!w(t)){o("Password must contain at least one letter and one number");return}if(!m(t,i)){o("Passwords do not match");return}try{f(!0),o("");const{resetToken:r}=g.state||{};if(!r){o("Invalid reset token. Please request a new password reset.");return}const c=await b.put("/auth/otp/reset",{newPassword:t.trim()},{headers:{Authorization:`Bearer ${r}`}});c.data.success?(T.success("Password reset successfully! Please sign in with your new password."),d("/login")):o(c.data.message||"Password reset failed")}catch(r){console.error("Password reset error:",r);const c=r.response?.data?.message||r.message||"Password reset failed. Please try again.";o(c)}finally{f(!1)}},[t,i,u,w,m,b,d,g.state]),v=a.useCallback(()=>{d("/login")},[d]),k=a.useCallback(e=>{j(e.target.value),l&&o("")},[l]),L=a.useCallback(e=>{N(e.target.value),l&&o("")},[l]),E=a.useCallback(()=>{y(e=>!e)},[]),S=a.useMemo(()=>u(t)&&w(t)&&m(t,i),[t,i,u,w,m]),A=a.useMemo(()=>n?"Resetting...":"Reset Password",[n]);return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:s.jsxs(z,{className:"w-full max-w-md shadow-xl",children:[s.jsxs(F,{className:"text-center space-y-2",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(H,{className:"w-6 h-6 text-blue-600"})}),s.jsx(I,{className:"text-2xl font-bold text-gray-900",children:"Reset Password"}),s.jsx(D,{className:"text-gray-600",children:"Enter your new password below."})]}),s.jsx(V,{children:s.jsxs("form",{onSubmit:C,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"newPassword",className:"text-sm font-medium text-gray-700",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(P,{id:"newPassword",type:x?"text":"password",placeholder:"Enter new password",value:t,onChange:k,className:"w-full pr-10",disabled:n,required:!0}),s.jsx(h,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:E,disabled:n,children:x?s.jsx(O,{className:"h-4 w-4"}):s.jsx(Z,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Must be at least 6 characters with letters and numbers"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Confirm New Password"}),s.jsx(P,{id:"confirmPassword",type:"password",placeholder:"Confirm new password",value:i,onChange:L,className:"w-full",disabled:n,required:!0})]}),l&&s.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:l}),s.jsxs(h,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:!S||n,children:[n&&s.jsx(q,{className:"w-4 h-4 mr-2 animate-spin"}),A]}),s.jsxs(h,{type:"button",variant:"ghost",onClick:v,className:"w-full text-gray-600 hover:text-gray-800",disabled:n,children:[s.jsx($,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]})})]})})}export{Y as default};
